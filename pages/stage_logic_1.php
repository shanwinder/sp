<?php
// File: stage_logic_1.php
session_start();
require_once '../includes/auth.php';
require_once '../includes/db.php';
requireStudent(); // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ

$user_id = $_SESSION['user_id'];
$stage_id = 1;
$game_title = "‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå";
$next_stage_link = "stage_logic_2.php";
?>

<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>‡πÄ‡∏Å‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå - ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="../assets/css/game_common.css">
    <link rel="stylesheet" href="../assets/css/game_header.css">
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <script>
        const USER_ID = <?= $user_id ?>;
        const STAGE_ID = <?= $stage_id ?>;
    </script>
    <script src="../assets/js/shared/game_common.js"></script>
    <script src="../assets/js/logic_game/stage1.js"></script>

    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(to right, #fef3c7, #bae6fd);
            margin: 0;
            padding-top: 80px;
        }

        #game-container {
            width: 100%;
            max-width: 900px;
            aspect-ratio: 3 / 2;
            background-color: #fff3cd;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .btn-nav {
            margin-left: 10px;
        }

        @media (max-width: 576px) {
            #game-container {
                width: 100%;
                height: auto;
                aspect-ratio: 3 / 2;
            }
        }
    </style>
</head>

<body>

    <?php include '../includes/game_header.php'; ?>

    <div id="instruction-box" style="
    background-color: #fff8dc;
    border: 3px dashed #facc15;
    border-radius: 16px;
    padding: 20px;
    max-width: 900px;
    margin: 20px auto;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
">

        <h4 style="margin-top:0; font-weight: bold; color: #b45309;">üìù ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h4>
        <p style="font-size: 1.1rem; margin-bottom: 8px;">
            ‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á
            ‡πÇ‡∏î‡∏¢‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£ <strong>‡∏ß‡∏ô‡∏ã‡πâ‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö 3 ‡∏ï‡∏±‡∏ß</strong> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <strong>2 ‡∏£‡∏≠‡∏ö</strong>
            ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <strong>‡∏•‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ</strong> ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        </p>
        <p style="font-size: 1rem; color: #92400e;">
            üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏ß‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        </p>
        <div class="container my-3 text-center">
            <button class="btn btn-info px-4 py-2 fw-semibold"
                data-bs-toggle="modal" data-bs-target="#preLessonModal">
                üìò ‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô
            </button>
        </div>

    </div>

    <div id="game-wrapper">
        <div id="game-container" style="margin: auto; width: 900px; height: 600px;"></div>
    </div>
    <div id="feedback-popup" style="
    display:none; position:fixed; top:30%; left:50%; transform:translate(-50%, -50%);
    background:#fff8dc; border:3px solid #facc15; padding:30px; border-radius:16px;
    font-size:28px; text-align:center; box-shadow:0 10px 20px rgba(0,0,0,0.2); z-index:999;
    animation: popIn 0.6s ease;
"></div>

    <style>
        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0.6);
                opacity: 0;
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .prelearn-card {
            border: 2px solid #e0e7ff;
            border-radius: 14px;
        }

        .prelearn-card .card-header {
            background: #eef2ff;
            font-weight: 700;
            border-bottom: 2px solid #e0e7ff;
        }

        .badge-step {
            background: #dbeafe;
            color: #1e3a8a;
        }

        .list-hint li {
            margin-bottom: .35rem;
        }
    </style>


    <?php include '../includes/student_footer.php'; ?>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- Modal: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° (Pattern & ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î) -->
    <div class="modal fade" id="preLessonModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°: ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö (Pattern)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="‡∏õ‡∏¥‡∏î"></button>
                </div>

                <div class="modal-body">
                    <!-- ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ & ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç -->
                    <div class="card prelearn-card mb-3">
                        <div class="card-header">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ &amp; ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
                        <div class="card-body">
                            <ul class="mb-2">
                                <li>‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å <strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥</strong> (‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ß‡∏ô‡∏ã‡πâ‡∏≥ ‡πÄ‡∏ä‡πà‡∏ô ‚Äúüê∂üê±‚Äù)</li>
                                <li>‡∏ó‡∏≥‡∏ï‡∏≤‡∏° <strong>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î 6 ‡∏Ç‡∏±‡πâ‡∏ô</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</li>
                                <li>‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤ ‚Äú‡∏ó‡∏≥‡πÑ‡∏°‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏∂‡∏á‡πÉ‡∏ä‡πà‚Äù ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏≤</li>
                            </ul>
                            <div class="small text-muted">‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥ ‚Ä¢ ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‚Ä¢ ‡∏Å‡∏é</div>
                        </div>
                    </div>

                    <!-- ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î 6 ‡∏Ç‡∏±‡πâ‡∏ô -->
                    <div class="card prelearn-card mb-3">
                        <div class="card-header">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î 6 ‡∏Ç‡∏±‡πâ‡∏ô (‡∏à‡∏≥‡∏á‡πà‡∏≤‡∏¢ ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á)</div>
                        <div class="card-body">
                            <ol class="mb-0">
                                <li><span class="badge badge-step rounded-pill me-1">1</span><strong>‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï</strong> ‚Äì ‡∏°‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏ß‡∏Å‡πà‡∏≠‡∏ô ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£ ‚Äú‡∏ß‡∏ô‡∏ã‡πâ‡∏≥/‡∏™‡∏•‡∏±‡∏ö‚Äù ‡πÑ‡∏´‡∏°</li>
                                <li><span class="badge badge-step rounded-pill me-1">2</span><strong>‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°</strong> ‚Äì ‡∏•‡∏≠‡∏á‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô üê∂üê± | üê∂üê± | ‚Ä¶</li>
                                <li><span class="badge badge-step rounded-pill me-1">3</span><strong>‡∏´‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥</strong> ‚Äì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏™‡∏°‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô ‚Äúüê∂üê±‚Äù</li>
                                <li><span class="badge badge-step rounded-pill me-1">4</span><strong>‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏é</strong> ‚Äì ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Å‡∏é‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‚Äú‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏°‡∏≤‚Äì‡πÅ‡∏°‡∏ß ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏¢‡∏≤‡∏ß 2‚Äù</li>
                                <li><span class="badge badge-step rounded-pill me-1">5</span><strong>‡∏ó‡∏î‡∏™‡∏≠‡∏ö</strong> ‚Äì ‡πÄ‡∏≠‡∏≤‡∏Å‡∏é‡πÑ‡∏õ‡∏•‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏ñ‡∏±‡∏î ‡πÜ ‡πÑ‡∏õ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏é‡πÉ‡∏´‡∏°‡πà</li>
                                <li><span class="badge badge-step rounded-pill me-1">6</span><strong>‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</strong> ‚Äì ‡πÉ‡∏ä‡πâ‡∏Å‡∏é‡∏ó‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ñ‡∏≤‡∏° ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</li>
                            </ol>
                        </div>
                    </div>

                    <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡πá‡∏ß -->
                    <div class="card prelearn-card mb-3">
                        <div class="card-header">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡πá‡∏ß</div>
                        <div class="card-body">
                            <div class="mb-2">
                                <strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 1: ABAB‚Ä¶</strong><br>
                                üê∂üê± | üê∂üê± | üê∂ ? ‚Üí ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥ = ‚Äúüê∂üê±‚Äù (‡∏¢‡∏≤‡∏ß 2) ‚Üí ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà 6 = ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 2 ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‚Üí <em>üê±</em>
                            </div>
                            <div class="mb-2">
                                <strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 2: AAB AAB‚Ä¶</strong><br>
                                üêºüêºüêµ | üêºüêºüêµ | üêº ? ? ‚Üí ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥ = ‚Äúüêºüêºüêµ‚Äù (‡∏¢‡∏≤‡∏ß 3) ‚Üí ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà 6 = ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 3 ‚Üí <em>üêµ</em>
                            </div>
                            <div>
                                <strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 3: ABC ABC‚Ä¶</strong><br>
                                üêØüê∏üêî | üêØüê∏üêî | üêØ ? ? ‚Üí ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥ = ‚ÄúüêØüê∏üêî‚Äù (‡∏¢‡∏≤‡∏ß 3) ‚Üí 10 √∑ 3 ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 1 ‚Üí ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 1 ‚Üí <em>üêØ</em>
                            </div>
                        </div>
                    </div>

                    <!-- ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö & ‡∏à‡∏∏‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ö‡πà‡∏≠‡∏¢ -->
                    <div class="card prelearn-card mb-1">
                        <div class="card-header">‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö &amp; ‡πÅ‡∏Å‡πâ‡∏à‡∏∏‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ö‡πà‡∏≠‡∏¢</div>
                        <div class="card-body">
                            <ul class="list-hint mb-0">
                                <li>‡∏≠‡∏¢‡πà‡∏≤‡∏£‡∏µ‡∏ö‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å 2‚Äì3 ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å ‡πÉ‡∏´‡πâ ‚Äú‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‚Äì‡∏ó‡∏î‡∏™‡∏≠‡∏ö‚Äù ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏´‡∏ô‡πà‡∏ß‡∏¢</li>
                                <li>‡∏ñ‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ã‡πâ‡∏≥‡∏î‡∏π‡πÅ‡∏õ‡∏•‡∏Å ‡∏•‡∏≠‡∏á‡∏¢‡πâ‡∏≤‡∏¢‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á (‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏∑‡∏≠ AAB ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà AA)</li>
                                <li>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏Ç‡πÉ‡∏ï‡πâ‡∏£‡∏π‡∏õ 1‚Äì10 ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏°‡πà‡∏´‡∏•‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</li>
                            </ul>
                        </div>
                    </div>
                </div> <!-- /modal-body -->

                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
                </div>

            </div>
        </div>
    </div>

    <!-- (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) Log ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏°‡∏î‡∏±‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ö‡∏ó‡∏ó‡∏µ‡πà 4 -->
    <script>
        (function() {
            const el = document.getElementById('preLessonModal');
            if (!el) return;
            el.addEventListener('shown.bs.modal', async () => {
                try {
                    await fetch('../api/lesson_event.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            event_type: 'prelesson_view',
                            stage_key: 'logic_1'
                        })
                    });
                } catch (e) {}
            });
        })();
    </script>

</body>

</html>